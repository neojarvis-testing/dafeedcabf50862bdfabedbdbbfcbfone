{"version":3,"file":"auth.spec.js","sourceRoot":"","sources":["../../../test/public/auth.spec.ts"],"names":[],"mappings":"AAAA,uCAAuC;AACvC,kCAAkC;AAElC,OAAO,EAEL,gCAAgC,EAChC,aAAa,GACd,MAAM,qBAAqB,CAAC;AAE7B,OAAO,EAAE,sBAAsB,EAAE,MAAM,WAAW,CAAC;AAEnD,OAAO,EAAE,MAAM,EAAE,MAAM,MAAM,CAAC;AAC9B,OAAO,EAAE,MAAM,EAAE,MAAM,kBAAkB,CAAC;AAE1C,QAAQ,CAAC,gBAAgB,EAAE,GAAG,EAAE;IAC9B,IAAI,gBAAkC,CAAC;IACvC,IAAI,QAAkB,CAAC;IAEvB,UAAU,CAAC,KAAK;QACd,QAAQ,GAAG,MAAM,aAAa,CAAC,IAAI,CAAC,CAAC;QACrC,gBAAgB,GAAG,gCAAgC,EAAE,CAAC;IACxD,CAAC,CAAC,CAAC;IAEH,SAAS,CAAC,KAAK;QACb,MAAM,QAAQ,CAAC,IAAI,EAAE,CAAC;IACxB,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,4BAA4B,EAAE,KAAK;QACpC,IAAI,CAAC,MAAM,EAAE,CAAC;YACZ,IAAI,CAAC,IAAI,EAAE,CAAC;QACd,CAAC;QACD,MAAM,MAAM,GAAG,IAAI,sBAAsB,CACvC,gBAAgB,CAAC,QAAQ,EACzB,gBAAgB,CAAC,UAAU,EAC3B,QAAQ,CAAC,sBAAsB,CAAC,EAAE,CAAC,CACpC,CAAC;QAEF,4DAA4D;QAC5D,uCAAuC;QACvC,MAAM,MAAM,CAAC,uBAAuB,CAAC;YACnC,GAAG,EAAE,6BAA6B,QAAQ,CAAC,QAAQ,CAAC,SAAS,EAAE,IAAI,IAAI,EAAE,CAAC,QAAQ,EAAE,CAAC,EAAE;YACvF,KAAK,EAAE,OAAO;SACf,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC;AAEH,QAAQ,CAAC,gDAAgD,EAAE,GAAG,EAAE;IAC9D,EAAE,CAAC,wDAAwD,EAAE,GAAG,EAAE;QAChE,MAAM,CAAC,MAAM,CACX,GAAG,EAAE,CAAC,IAAI,sBAAsB,CAAC,8BAA8B,CAAC,EAChE,6HAA6H,CAC9H,CAAC;IACJ,CAAC,CAAC,CAAC;IAEH,EAAE,CAAC,0DAA0D,EAAE,GAAG,EAAE;QAClE,MAAM,CAAC,MAAM,CACX,GAAG,EAAE,CAAC,IAAI,sBAAsB,CAAC,SAAgB,CAAC,EAClD,6HAA6H,CAC9H,CAAC;IACJ,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","sourcesContent":["// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n\nimport {\n  CredsAndEndpoint,\n  getTokenAuthenticationCredential,\n  startRecorder,\n} from \"./utils/testHelpers\";\nimport { Recorder } from \"@azure-tools/test-recorder\";\nimport { AppConfigurationClient } from \"../../src\";\nimport { Context } from \"mocha\";\nimport { assert } from \"chai\";\nimport { isNode } from \"@azure/core-util\";\n\ndescribe(\"Authentication\", () => {\n  let credsAndEndpoint: CredsAndEndpoint;\n  let recorder: Recorder;\n\n  beforeEach(async function (this: Context) {\n    recorder = await startRecorder(this);\n    credsAndEndpoint = getTokenAuthenticationCredential();\n  });\n\n  afterEach(async function () {\n    await recorder.stop();\n  });\n\n  it(\"token authentication works\", async function () {\n    if (!isNode) {\n      this.skip();\n    }\n    const client = new AppConfigurationClient(\n      credsAndEndpoint.endpoint,\n      credsAndEndpoint.credential,\n      recorder.configureClientOptions({}),\n    );\n\n    // it doesn't matter if any data comes in so long as we were\n    // able to connect and call the service\n    await client.addConfigurationSetting({\n      key: `token-authentication-test-${recorder.variable(\"label-1\", new Date().toString())}`,\n      value: \"hello\",\n    });\n  });\n});\n\ndescribe(\"AppConfigurationClient constructor error cases\", () => {\n  it(\"invalid connection string gives a decent error message\", () => {\n    assert.throws(\n      () => new AppConfigurationClient(\"an invalid connection string\"),\n      /Invalid connection string\\. Valid connection strings should match the regex 'Endpoint=\\(\\.\\*\\);Id=\\(\\.\\*\\);Secret=\\(\\.\\*\\)'/,\n    );\n  });\n\n  it(\"undefined connection string gives a decent error message\", () => {\n    assert.throws(\n      () => new AppConfigurationClient(undefined as any),\n      /Invalid connection string\\. Valid connection strings should match the regex 'Endpoint=\\(\\.\\*\\);Id=\\(\\.\\*\\);Secret=\\(\\.\\*\\)'/,\n    );\n  });\n});\n"]}