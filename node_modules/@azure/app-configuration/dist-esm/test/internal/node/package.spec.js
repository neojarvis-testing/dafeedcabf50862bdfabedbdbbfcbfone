// Copyright (c) Microsoft Corporation.
// Licensed under the MIT license.
import { assert } from "chai";
import { AppConfigurationClient } from "../../../src/appConfigurationClient";
import { packageVersion } from "../../../src/internal/constants";
describe("packagejson related tests", () => {
    // if this test is failing you need to update the contant `packageVersion` referenced above
    // in the generated code.
    it("user agent string matches the package version", async function () {
        let userAgent;
        const client = new AppConfigurationClient("https://myresource.azconfig.io", {
            getToken: (_scopes) => {
                return Promise.resolve({
                    token: "fakevalue",
                    expiresOnTimestamp: new Date().getTime() + 24 * 60 * 60 * 1000,
                });
            },
        }, {
            httpClient: {
                sendRequest: async (request) => {
                    var _a;
                    userAgent = (_a = request.headers.get("user-agent")) !== null && _a !== void 0 ? _a : request.headers.get("x-ms-useragent");
                    throw new Error("only a test");
                },
            },
        });
        try {
            await client.getSnapshot("name");
        }
        catch (_a) {
            // no-op, we don't care about the response, only the user-agent header
        }
        assert.exists(userAgent, "Expected a User-Agent header to be sent");
        assert.include(userAgent, `azsdk-js-app-configuration/${packageVersion}`);
    });
});
//# sourceMappingURL=package.spec.js.map